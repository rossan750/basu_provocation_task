(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,function(t,e,n){"use strict";n.d(e,"c",function(){return U}),n.d(e,"e",function(){return v}),n.d(e,"g",function(){return _}),n.d(e,"i",function(){return w}),n.d(e,"b",function(){return S}),n.d(e,"f",function(){return j}),n.d(e,"h",function(){return P}),n.d(e,"a",function(){return y}),n.d(e,"j",function(){return I});var r=n(15),a=n(21),o=n.n(a),i=n(30);n.d(e,"d",function(){return i.eventCodes});var c=!r.jsPsych.turk.turkInfo().outsideTurk,s="true"===Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_VIDEO,u="true"===Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_FIREBASE,d=!0;try{window.require("electron")}catch(T){d=!1}var p="true"===Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_VOLUME,l="true"===Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_HIDE_FRAME_ELECTRON&&d,f="true"===Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_USE_EEG&&d,h="true"===Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_USE_PHOTODIODE&&d,m=Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_BREATHING_AUDIO||"breathing_exercise",v={width:600,height:600},_=10,b=function(t){return t.keys().map(t)},g=(i.eventCodes.open_provoc_task,b(n(50))),E=b(n(54)),O=b(n(59)),k=b(n(61)),y=o.a.filter(k,function(t){return t.includes(m)})[0];console.log(y);var w={min:0,max:10,canvasSize:640,circleRadius:28,cursorRadius:7.5},j=n(64);if(c){var x=n(65);o.a.merge(j,x)}var S={num_repeats:2,images:{neutral:g,provoking:E},repeats_per_condition:3,is_practice:!1},P={images:{neutral:O,provoking:[]},repeats_per_condition:1,is_practice:!0},I="Provocation",U={USE_MTURK:c,USE_VIDEO:s,USE_ELECTRON:d,USE_FIREBASE:u,USE_EEG:f,HIDE_FRAME_ELECTRON:l,USE_PHOTODIODE:h,USE_VOLUME:p}},,,,,,,function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"<div class=".concat(e?"main-prompt":"task-container",">").concat(t,"</div>")}},function(t,e,n){"use strict";n.d(e,"b",function(){return s}),n.d(e,"a",function(){return u});var r=n(2),a=n(11),o=n.n(a),i=!1;if(r.c.USE_ELECTRON){var c=window.require("electron");i=c.ipcRenderer}var s=function(){var t=r.c.USE_PHOTODIODE?"visible":"invisible";return'<div class="photodiode-box '.concat(t,'" id="photodiode-box">\n\t\t\t\t\t\t\t\t\t<span id="photodiode-spot" class="photodiode-spot"></span>\n  \t\t\t\t\t\t\t\t</div>')},u=function(t){if(r.c.USE_PHOTODIODE){var e=t;t<r.d.open_provoc_task&&(e=1),function t(e,n){n>0&&function(t,e){o()(".photodiode-spot").css({"background-color":"white"}),setTimeout(function(){o()(".photodiode-spot").css({"background-color":"black"}),e()},t)}(e,function(){setTimeout(function(){t(e,n-1)},e)})}(40,e),i&&(i.send("trigger",t),setTimeout(function(){i.send("trigger",0)},5))}}},,,,,,,,,,,,,,,,,,,,function(t,e){t.exports={eventCodes:{open_provoc_task:13,fixation:1,evidence:5,show_ratings:7,rate:2,start_break:8,test_connect:32}}},,,,,function(t,e,n){"use strict";(function(t){var r=n(8),a=n.n(r),o=n(36),i=n(16),c=n(2),s=n(10),u=n(9),d=n(15),p=!1;if(c.c.USE_ELECTRON){var l=window.require("electron");p=l.ipcRenderer}e.a=function(){document.title=c.j;var e='\n  <div class="d-flex flex-column align-items-center">\n  <p>'.concat(c.f.instructions.camera,'</p>\n  <video id="camera" width="640" height="480" autoplay></video>\n  </div>\n  ');return{type:"html_button_response",stimulus:Object(u.a)(e,!1)+Object(s.b)(),choices:[c.f.prompt.continue.button],response_ends_trial:!0,on_load:function(){var e=d.jsPsych.data.get().values()[0].participant_id,n=document.getElementById("camera"),r=function(r,a){console.log(r),"cameraCapture"===a&&(n.srcObject=r);var o=[];window[a]=new MediaRecorder(r,{mimeType:"video/webm"}),window[a].addEventListener("dataavailable",function(t){t.data.size>0&&o.push(t.data)}),window[a].addEventListener("stop",function(){!function(e,n,r){var a=new FileReader,o="pid_".concat(r,"_").concat(n,"_").concat(Date.now(),".webm");a.onload=function(){if(2===a.readyState){var e=new t(a.result);p.send("save_video",o,e)}},a.readAsArrayBuffer(e)}(new Blob(o),a,e)})};navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){return r(t,"cameraCapture")}),window.require("electron").desktopCapturer.getSources({types:["window"]}).then(function(){var t=Object(i.a)(a.a.mark(function t(e){var n,i,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(o.a)(e);try{for(n.s();!(i=n.n()).done;)(s=i.value).name===c.j&&navigator.mediaDevices.getUserMedia({video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s.id}}}).then(function(t){r(t,"screenCapture")}).catch(function(t){return console.log(t)})}catch(a){n.e(a)}finally{n.f()}case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},on_finish:function(){c.c.USE_ELECTRON&&(window.cameraCapture.start(),window.screenCapture.start())}}}}).call(this,n(66).Buffer)},,function(t){t.exports={a:"2.2.0"}},,function(t,e,n){t.exports=n(73)},,,,,function(t,e,n){},,function(t,e,n){},,,,function(t,e,n){var r={"./1_happy.jpg":51,"./2_happy.jpg":52,"./3_happy.jpg":53};function a(t){var e=o(t);return n(e)}function o(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}a.keys=function(){return Object.keys(r)},a.resolve=o,t.exports=a,a.id=50},function(t,e,n){t.exports=n.p+"static/media/1_happy.18aba42e.jpg"},function(t,e,n){t.exports=n.p+"static/media/2_happy.9545f071.jpg"},function(t,e,n){t.exports=n.p+"static/media/3_happy.c893ae7f.jpg"},function(t,e,n){var r={"./4_sad.jpeg":55,"./5_sad.jpeg":56,"./6_sad.jpeg":57,"./7_unknown.jpeg":58};function a(t){var e=o(t);return n(e)}function o(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}a.keys=function(){return Object.keys(r)},a.resolve=o,t.exports=a,a.id=54},function(t,e,n){t.exports=n.p+"static/media/4_sad.104fb27c.jpeg"},function(t,e,n){t.exports=n.p+"static/media/5_sad.ef6dac84.jpeg"},function(t,e,n){t.exports=n.p+"static/media/6_sad.bb879b1e.jpeg"},function(t,e,n){t.exports=n.p+"static/media/7_unknown.c348d28c.jpeg"},function(t,e,n){var r={"./istockphoto-888845986-612x612.jpg":60};function a(t){var e=o(t);return n(e)}function o(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}a.keys=function(){return Object.keys(r)},a.resolve=o,t.exports=a,a.id=59},function(t,e,n){t.exports=n.p+"static/media/istockphoto-888845986-612x612.23164b56.jpg"},function(t,e,n){var r={"./PlaceHolderBreathingForButler.m4a":62,"./breathing_exercise.m4a":63};function a(t){var e=o(t);return n(e)}function o(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}a.keys=function(){return Object.keys(r)},a.resolve=o,t.exports=a,a.id=61},function(t,e,n){t.exports=n.p+"static/media/PlaceHolderBreathingForButler.baf2b4f7.m4a"},function(t,e,n){t.exports=n.p+"static/media/breathing_exercise.b4b71d9b.m4a"},function(t){t.exports={task:{name:"Provocation Task",end:"This experiment has ended."},prompt:{skip:"Skip breathing exercise",continue:{press:"Press any key to continue.",button:"Continue"},focus:"Make sure the photodiode is aligned and the EEG recording has begun before continuing.",setting_up:"Setting up task, please wait..."},eventMarker:{found:"Hold the USB event marker in front of the camera.",not_found:"Note: no USB event marker found."},instructions:{welcome:"Welcome!",p1:"During the task, you will see a series of neutral images and anxiety-provoking images.",p2:"You will be asked to rate your level of distress from 0-10 in response to each image, where 0 is no distress and 10 is the highest level of distress.",fixation:"Throughout the experiment, you'll see this fixation point at the center of the screen. <br> Try to keep your eyes focused on the fixation point during the task.",rate:"Next, you will do one practice trial. You will see the fixation point, followed by an image. Then, you will be asked to submit your rating when you\u2019re ready.",rate_practice:"Try submitting a rating of \u201c5\u201d by dragging the cursor to \u201c5\u201d and clicking to submit.",no_talking:"Try not to talk or move around more than necessary, as movements affect the quality of the recordings.",instruction_end:"In a few moments, the task will begin.",block_end:"Block 1 of 2 is now complete.",block_break:"Take a 10 second break and continue to block 2 of 2.",adjust_volume:"Set tablet volume to 50/100.",camera:"Make sure the camera is pointing to you and your face is within the camera area.",breathing:"Halfway through the task, you will be guided through a 3 minute guided deep breathing exercise."},block:{end_p1:"Block ",end_p2:" of ",end_p3:" is now complete.",break_p1:"You will now do a 3 minute guided breathing exercise before continuing to block ",break_p2:" of ",break_p3:"."},countdown:{message:"Provocation will begin in:"}}},function(t){t.exports={}},,,,,,,,function(t,e,n){"use strict";n.r(e);var r=n(1),a=n.n(r),o=n(34),i=n.n(o),c=(n(44),n(8)),s=n.n(c),u=n(16),d=n(14),p=n(15),l=(n(46),n(47),n(48),function(t){return new Promise(function(e){return setTimeout(e,t)})}),f=function(t){return function(t,e){return t+Math.floor(Math.random()*Math.floor(e))}(t,50)},h=function(t){return JSON.parse(JSON.stringify(t))},m=function(t){for(var e,n,r=t.length;0!==r;)n=Math.floor(Math.random()*r),e=t[r-=1],t[r]=t[n],t[n]=e;return t},v=function(){var t=p.jsPsych.turk.turkInfo();return"".concat(t.workerId,":").concat(t.assignmentId)},b=n(22),g=(n(74),n(75),{apiKey:Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_apiKey,authDomain:Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_authDomain,projectId:Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_projectId||"no-firebase",storageBucket:Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_storageBucket,messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_messagingSenderId,appId:Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_appId});b.a.initializeApp(g);var E=b.a.firestore();"localhost"===window.location.hostname&&E.useEmulator("localhost",8080);var O=function(){var t=Object(u.a)(s.a.mark(function t(e,n,r){var a,o,i,c,d;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(n,"/").concat(e,"/").concat(r),o=b.a.storage(),i=o.ref(a),t.next=5,i.listAll();case 5:return c=t.sent,d=c.items.map(function(){var t=Object(u.a)(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDownloadURL();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),t.next=9,Promise.all(d);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}},t)}));return function(e,n,r){return t.apply(this,arguments)}}(),k=function(t,e,n){return E.collection("participant_responses").doc(e).collection("participants").doc(t).collection("data").doc(n).set({start_time:n,app_version:window.navigator.appVersion,app_platform:window.navigator.platform,results:[]}).then(function(){return!0}).catch(function(){return!1})},y=function(t){var e=t.participant_id,n=t.study_id,r=t.start_date;E.collection("participant_responses").doc(n).collection("participants").doc(e).collection("data").doc(r).update("results",b.a.firestore.FieldValue.arrayUnion(t)).then(function(){return!0}).catch(function(t){return console.error("Error adding to Firebase:",t),!1})},w=b.a.firestore,j=(w.TimeStamp,w.GeoPoint,b.a,n(2)),x=n(25),S=n(10),P=n(11),I=n.n(P),U=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(n?'<div class="task-container"><div id="fixation-dot" class="color-green"> </div></div>':'<div class="task-container"><div id="fixation-dot" class="color-white"> </div></div>')+Object(S.b)(),o=j.d.fixation,i=e?f(t):t;return{type:"html_keyboard_response",choices:p.jsPsych.NO_KEYS,stimulus:a,response_ends_trial:!1,trial_duration:i,on_load:function(){Object(S.a)(o),r&&I()("html").css("cursor","none")},on_finish:function(t){t.code=o,r&&I()("html").css("cursor","auto")}}},T=function(t,e){var n=j.d.evidence;return{type:"image_keyboard_response",stimulus:t,prompt:Object(S.b)(),response_ends_trial:!1,trial_duration:f(e),on_load:function(){I()("#jspsych-image-keyboard-response-stimulus").addClass("image"),I()("#jspsych-image-keyboard-response-stimulus").height(j.e.height),I()("#jspsych-image-keyboard-response-stimulus").width(j.e.width),I()("html").css("cursor","none"),Object(S.a)(n)},on_finish:function(t){t.code=n,I()("html").css("cursor","auto")}}},D=n(21),C=n.n(D),N=function(t,e,n,r,a){var o=t-r,i=e-a;return Math.sqrt(o*o+i*i)<n},R=function(t,e,n,r,a){for(var o=0;o<r.length;o++){var i=r[o];if(N(i.x,i.y,a,t,e))return i}return null},L=j.i.canvasSize,A=j.i.circleRadius,M=j.i.cursorRadius,B='<canvas width="'.concat(L,'" height="').concat(L,'" id="jspsych-canvas">\n    Your browser does not support HTML5 canvas\n  </canvas>'),F=function(){var t='<div class="task-container">'+B+Object(S.b)()+"</div>";return{type:"call_function",async:!0,func:function(e){var n=j.d.show_ratings,r=j.d.rate,a=Date.now();document.getElementById("jspsych-content").innerHTML=t;var o,i=document.querySelector("#jspsych-canvas"),c=i.getContext("2d");I()("html").css("cursor","none");var s=I()("#jspsych-canvas").width()/2,u=0,d=I()("#jspsych-canvas").height()/2,p=0,l=[],f=function(){return Date.now()-a},h=function(){return l.push({x:s,y:d,elapsed:f()})};h();var m=function(t,e,n){var r=n/2,a=.85*r,o=e-t+1,i=Math.PI/(o-1);return C.a.range(t,e+1).map(function(t){var e=i*t-Math.PI/2;return{n:t,x:a*Math.sin(e)+r,y:a*Math.cos(e)+r}})}(j.i.min,j.i.max,L),v=function(){c.clearRect(0,0,i.width,i.height),function(t,e,n){e<1e4||(t.font="20px arial",t.textBaseline="middle",t.textAlign="center",t.fillStyle="#ffffff",t.fillText("Please select a rating",n/2,.25*n))}(c,f(),L),function(t,e,n,r,a,o){t.font=.8*n+"px arial",t.textBaseline="middle",t.textAlign="center";var i=R(r,a,0,e,n);e.forEach(function(e){t.fillStyle=e===i?"#778899":"#D3D3D3",t.beginPath(),t.arc(e.x,e.y,n,0,2*Math.PI,!0),t.fill(),t.fillStyle="#000000",t.fillText(e.n.toString(),e.x,e.y+3.5)})}(c,m,A,s,d),function(t,e){t.fillStyle="#ffffff",t.beginPath(),t.arc(e/2,e/2,7.5,0,2*Math.PI,!0),t.fill()}(c,L),function(t,e,n,r){t.beginPath(),t.moveTo(e,n-r),t.lineTo(e,n+r),t.moveTo(e-r,n),t.lineTo(e+r,n),t.lineWidth=3,t.strokeStyle="#a6a6a6",t.stroke()}(c,s,d,M)};v(),Object(S.a)(n),setTimeout(v,1e4);try{i.requestPointerLock()}catch(b){console.warn("pointer lock denied")}var _=function(t){s+=t.originalEvent.movementX,d+=t.originalEvent.movementY;var e=Math.sign(t.originalEvent.movementX),n=Math.sign(t.originalEvent.movementY),r=!1;e!==u&&0!==e&&(h(),u=e,r=!0),n!==p&&0!==n&&(r||h(),p=n),s>i.width-M&&(s=i.width-M),d>i.height-M&&(d=i.height-M),s<M&&(s=M),d<M&&(d=M),o||(o=requestAnimationFrame(function(){o=null,v()}))};I()(document).bind("mousemove",_),I()(document).bind("click",function t(){var a=R(s,d,0,m,A);if(a){var o=f();Object(S.a)(r),h(),I()(document).unbind("mousemove",_),I()(document).unbind("click",t),setTimeout(function(){I()("html").css("cursor","auto"),e({circle:a,click:{x:s,y:d},code:[n,r],rt:o,path:l})},500)}})}}},V=function(t){return{type:"html_keyboard_response",timeline:[U(2e3,!0,!1,!0),U(200,!1,!0,!0),T(t,3e3),F()]}},q=function(t){return{type:"html_keyboard_response",timeline:function(t){for(var e=[],n=0;n<t.repeats_per_condition;n++){for(var r=m(h(t.images.neutral)),a=m(h(t.images.provoking));r.length>0&&a.length>0;)r.length-a.length>=3?e.push(r.pop()):a.length-r.length>=3?e.push(a.pop()):Math.random()>.5?e.push(r.pop()):e.push(a.pop());e.push.apply(e,Object(x.a)(r)),e.push.apply(e,Object(x.a)(a))}return e}(t).map(function(t){return V(t)})}},H=n(9),G=function(){return{type:"html_button_response",stimulus:Object(H.a)("<div><h1>".concat(j.f.task.name,"</h1></div>"),!0)+Object(S.b)(),prompt:"",choices:[j.f.prompt.continue.button]}},z=function(){return{type:"html_button_response",stimulus:Object(H.a)("<div>\n    <h2 id='usb-alert'></h2>\n    <br><p>".concat(j.f.prompt.focus,"</p>\n    </div>"),!0)+Object(S.b)(),choices:[j.f.prompt.continue.button]}},Y=Object(H.a)("\n    <div class='instructions'>\n    <h1>".concat(j.f.instructions.welcome,"</h1>\n    <p>").concat(j.f.instructions.p1,"</p>\n    <p>").concat(j.f.instructions.p2,"</p>\n    </div>\n    "),!0),K=Object(H.a)("\n    <div class='instructions'>\n    <p>".concat(j.f.instructions.fixation,'</p>\n    <div id="fixation-dot" class="color-white"></div>\n    </div>\n    '),!0),J=Object(H.a)("\n    <div class='instructions'>\n    <p>".concat(j.f.instructions.rate,"</p>\n    </div>\n    "),!0),W=Object(H.a)("\n    <div class='instructions'>\n    <p>".concat(j.f.instructions.rate_practice,"</p>\n    </div>\n    "),!0),X=Object(H.a)("\n    <div class='instructions'>\n    <p>".concat(j.f.instructions.no_talking,"</p>\n    </div>\n    "),!0),Q=Object(H.a)("\n    <div class='instructions'>\n    <p>".concat(j.f.instructions.instruction_end,"</p>\n    </div>\n    "),!0),Z={type:"instructions",show_clickable_nav:!0,pages:[Y,Object(H.a)("\n  <div class='instructions'>\n  <p>".concat(j.f.instructions.breathing,"</p>\n  </div>\n  "),!0),K,J,W]},$={type:"instructions",show_clickable_nav:!0,pages:[X,Q]},tt=function(){return{type:"html_button_response",stimulus:Object(H.a)("\n    <div class='instructions'>\n    <h1>".concat(j.f.instructions.adjust_volume,"</h1>\n    </div>\n    "),!0),choices:[j.f.prompt.continue.button],response_ends_trial:!0}},et=n(35),nt=function(t,e){var n=D.range(e,0,-1).map(function(t){return{prompt:"<h1>".concat(t,"</h1>")}});return{type:"html_keyboard_response",stimulus:Object(H.a)("<h3>".concat(t,"</h3>"),!0),trial_duration:1e3,response_ends_trial:!1,timeline:n}},rt=function(t,e){var n=j.d.start_break,r=Object(H.a)("\n    <div class='instructions'>\n  <h1>".concat(j.f.block.end_p1,"\n    ").concat(t,"\n    ").concat(j.f.block.end_p2,"\n    ").concat(e,"\n    ").concat(j.f.block.end_p3,"</h1>\n  <h2>").concat(j.f.block.break_p1,"\n    ").concat(t+1,"\n    ").concat(j.f.block.break_p2,"\n    ").concat(e,"\n    ").concat(j.f.block.break_p3,"</h2>\n  </div>"),!0)+Object(S.b)();return{type:"audio_keyboard_response",stimulus:j.a,prompt:r,choices:[],response_ends_trial:!1,trial_ends_after_audio:!0,on_load:function(){Object(S.a)(n)},on_finish:function(t){t.code=n}}},at=function(t){return{type:"html_keyboard_response",stimulus:Object(H.a)("<h1>".concat(j.f.task.end,"</h1>"),!0)+Object(S.b)(),trial_duration:t,on_load:function(){j.c.USE_VIDEO&&(console.log("finished"),window.cameraCapture.stop(),window.screenCapture.stop())}}},ot=n(27),it=n.n(ot),ct=!1,st=!1,ut=!1,dt=function(){var t=Object(u.a)(s.a.mark(function t(e,n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={neutral:[],provoking:[]},t.next=3,O(e,n,"neutral");case 3:return r.neutral=t.sent,t.next=6,O(e,n,"provoking");case 6:return r.provoking=t.sent,t.abrupt("return",r);case 8:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),pt=function(t){var e=t.neutral.length,n=t.provoking.length;if(e!==j.g||n!==j.g){var r="Number of images provided does not meet requirement.  Found ".concat(e," neutral images and ").concat(n," provoking images, the settings for this task requires ").concat(j.g," of each type.");j.c.USE_ELECTRON?ut.send("error",r):alert(r)}},lt=function(t,e){var n=it.a.join(ct.getPath("desktop"),"provocation-images","".concat(t)),r=it.a.join(n,e);return st.readdirSync(r).map(function(t){return"file://"+it.a.join(r,t)})},ft=function(){var t=Object(u.a)(s.a.mark(function t(e,n){var r,a,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!j.c.USE_ELECTRON){t.next=19;break}return ct=window.require("electron").remote.app,st=window.require("fs"),r=window.require("electron"),ut=r.ipcRenderer,t.prev=5,(a={}).neutral=lt(e,"neutral"),a.provoking=lt(e,"provoking"),pt(a),t.abrupt("return",a);case 13:t.prev=13,t.t0=t.catch(5),console.warn("Error loading local files - using default images"),ut.send("error","Could not load images from local device. - ".concat(t.t0));case 17:t.next=25;break;case 19:if(!j.c.USE_FIREBASE){t.next=25;break}return t.next=22,dt(e,n);case 22:return o=t.sent,pt(o),t.abrupt("return",o);case 25:case"end":return t.stop()}},t,null,[[5,13]])}));return function(e,n){return t.apply(this,arguments)}}(),ht=function(){var t=Object(u.a)(s.a.mark(function t(e,n,r){var a,o,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft(e,n);case 2:for(a=t.sent,r.images.neutral=a.neutral,r.images.provoking=a.provoking,o=[],i=1;i<r.num_repeats;i++)o.push(nt(j.f.countdown.message,3),q(r),rt(i,r.num_repeats));return t.abrupt("return",o);case 8:case"end":return t.stop()}},t)}));return function(e,n,r){return t.apply(this,arguments)}}(),mt=function(){var t=Object(u.a)(s.a.mark(function t(e,n){var r,a,o,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=[G()],j.c.USE_VOLUME&&r.push(tt()),j.c.USE_VIDEO&&r.push(Object(et.a)()),j.c.USE_EEG&&r.push(z()),r.push(Z,q(j.h),$),t.next=7,ht(e,n,j.b);case 7:return a=t.sent,r.push.apply(r,Object(x.a)(a)),r.push(at(5e3)),o=r,i=[],t.abrupt("return",j.c.USE_MTURK?i:o);case 13:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}();var vt=function(t){var e=t.dataUpdateFunction,n=t.dataFinishFunction,o=t.participantID,i=t.studyID,c=Object(r.useState)([]),s=Object(d.a)(c,2),u=s[0],l=s[1];return Object(r.useEffect)(function(){mt(o,i).then(function(t){return l(t)})},[o,i]),0===u.length?a.a.createElement("div",{className:"App height-100"},a.a.createElement("div",{className:"centered-h-v"},"Loading task")):a.a.createElement("div",{className:"App"},a.a.createElement(p.Experiment,{settings:{timeline:u,preload_audio:[j.a],on_data_update:function(t){return e(t)},on_finish:function(t){return n(t)}}}))},_t=n(20),bt=n(38);var gt=function(t){var e=t.onLogin,n=t.envParticipantId,o=t.envStudyId,i=t.validationFunction,c=Object(r.useState)(""),s=Object(d.a)(c,2),u=s[0],p=s[1],l=Object(r.useState)(""),f=Object(d.a)(l,2),h=f[0],m=f[1],v=Object(r.useState)(!1),_=Object(d.a)(v,2),b=_[0],g=_[1];return Object(r.useEffect)(function(){p(n),m(o)},[n,o]),a.a.createElement("div",{className:"centered-h-v"},a.a.createElement("div",{className:"width-50 max-width-600px"},b?a.a.createElement("div",{className:"alert alert-danger",role:"alert"},"The participant ID and study ID do not match"):null,a.a.createElement(_t.a,{className:"centered-h-v",onSubmit:function(t){t.preventDefault(),i(u,h).then(function(t){t?e(t,h,u):g(!0)})}},a.a.createElement(_t.a.Group,{className:"width-100",size:"lg",controlId:"participantId"},a.a.createElement(_t.a.Label,null,"Participant ID"),a.a.createElement(_t.a.Control,{autoFocus:!0,type:"participantId",value:u,onChange:function(t){return p(t.target.value)}})),a.a.createElement(_t.a.Group,{className:"width-100",size:"lg",controlId:"studyId"},a.a.createElement(_t.a.Label,null,"Study ID"),a.a.createElement(_t.a.Control,{type:"studyId",value:h,onChange:function(t){return m(t.target.value)}})),a.a.createElement(bt.a,{style:{width:"100%"},block:!0,size:"lg",type:"submit",disabled:!(u.length>0&&h.length>0)},"Log In"))))},Et=n(37);var Ot=function(){var t=Object(r.useState)(!1),e=Object(d.a)(t,2),n=e[0],o=e[1],i=Object(r.useState)(!1),c=Object(d.a)(i,2),f=c[0],h=c[1],m=Object(r.useState)(!1),b=Object(d.a)(m,2),g=b[0],E=b[1],O=Object(r.useState)(""),w=Object(d.a)(O,2),x=w[0],S=w[1],P=Object(r.useState)(""),I=Object(d.a)(P,2),U=I[0],T=I[1],D=Object(r.useState)(""),C=Object(d.a)(D,2),N=C[0],R=C[1],L=Object(r.useState)(""),A=Object(d.a)(L,2),M=A[0],B=A[1],F=Object(r.useState)("default"),V=Object(d.a)(F,2),q=V[0],H=V[1],G=Object(r.useState)(!1),z=Object(d.a)(G,2),Y=z[0],K=z[1],J=(new Date).toISOString(),W=new URLSearchParams(window.location.search),X=function(){var t=Object(u.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),Q=function(){},Z=Object(r.useCallback)(function(t,e,n){t&&p.jsPsych.data.addProperties({participant_id:n,study_id:e,start_date:J,task_version:Et.a}),S(n),T(e),o(t)},[J]);return Object(r.useEffect)(function(){if(console.log("Environment configuration:",j.c),j.c.USE_ELECTRON){var t=window.require("electron").ipcRenderer;h(t),t.send("updateEnvironmentVariables",j.c);var e=t.sendSync("syncCredentials");e.envParticipantId&&R(e.envParticipantId),e.envStudyId&&B(e.envStudyId),H("desktop")}else if(j.c.USE_MTURK){window.lodash=_.noConflict();var n=v();E(new PsiTurk(n,"/complete")),H("mturk"),Z(!0,"mturk",n)}else if(j.c.USE_FIREBASE){H("firebase");var r=W.get("participantID"),a=W.get("studyID");r&&R(r),a&&B(a)}else K(!0)},[]),Y?a.a.createElement("div",{className:"centered-h-v"},a.a.createElement("div",{className:"width-50 alert alert-danger"},"Please tell your task provider to enable Firebase.")):a.a.createElement(a.a.Fragment,null,n?a.a.createElement(vt,{dataUpdateFunction:{desktop:function(t){f.send("data",t)},firebase:function(t){y(t)},mturk:function(t){g.recordTrialData(t)},default:Q}[q],dataFinishFunction:{desktop:function(){f.send("end","true")},mturk:function(){!function(){var t=Object(u.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return g.saveData(),t.next=3,l(5e3);case 3:g.completeHIT();case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()()},firebase:Q,default:Q}[q],participantID:x,studyID:U}):a.a.createElement(gt,{validationFunction:{desktop:X,default:X,firebase:function(t,e){return k(t,e,J)}}[q],envParticipantId:N,envStudyId:M,onLogin:Z}))};i.a.render(a.a.createElement(Ot,null),document.getElementById("root"))}],[[39,1,2]]]);
//# sourceMappingURL=main.49bdabe9.chunk.js.map